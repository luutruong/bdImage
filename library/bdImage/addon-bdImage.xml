<?xml version="1.0" encoding="utf-8"?>
<addon addon_id="bdImage" title="[bd] Image" version_string="1.0" version_id="22" url="" install_callback_class="bdImage_Installer" install_callback_method="install" uninstall_callback_class="bdImage_Installer" uninstall_callback_method="uninstall">
  <admin_navigation/>
  <admin_permissions/>
  <admin_style_properties/>
  <admin_templates>
    <template title="bdimage_widget_options_attachments_grid"><![CDATA[<xen:spinboxunit label="{xen:phrase bdimage_rows}:" name="{$namePrefix}grid_rows" value="{xen:if '!empty({$options.grid_rows})', $options.grid_rows, 4}" />
<xen:spinboxunit label="{xen:phrase bdimage_columns}:" name="{$namePrefix}grid_columns" value="{xen:if '!empty({$options.grid_columns})', $options.grid_columns, 4}" />

<xen:spinboxunit label="{xen:phrase bdimage_thumbnail_width}" name="{$namePrefix}thumbnail_width" value="{xen:if 'isset({$options.thumbnail_width})', {$options.thumbnail_width}, 50}" min="1" step="25" />
<xen:spinboxunit label="{xen:phrase bdimage_thumbnail_height}" name="{$namePrefix}thumbnail_height" value="{xen:if 'isset({$options.thumbnail_height})', {$options.thumbnail_height}, 50}" min="1" step="25" />
<xen:spinboxunit label="{xen:phrase bdimage_gap}" name="{$namePrefix}gap" value="{xen:if 'isset({$options.gap})', {$options.gap}, 5}" min="1" step="5" />

<xen:selectunit label="{xen:phrase wf_threads_forums}:" name="{$namePrefix}forums" value="" size="5" multiple="true" inputclass="textCtrl">
	<xen:options source="$forums" />
	<xen:explain>{xen:phrase wf_threads_forums_explain} {xen:phrase wf_special_forums_explain}</xen:explain>
</xen:selectunit>

<xen:checkboxunit label="">
	<xen:option name="{$namePrefix}as_guest" value="1" selected="{$options.as_guest}">{xen:phrase wf_use_guest_permissions}</xen:option>
</xen:checkboxunit>
]]></template>
    <template title="bdimage_widget_options_slider_threads"><![CDATA[<xen:include template="wf_widget_options_threads" />

<xen:spinboxunit label="{xen:phrase bdimage_thumbnail_width}" name="{$namePrefix}thumbnail_width" value="{xen:if 'isset({$options.thumbnail_width})', {$options.thumbnail_width}, 100}" min="1" step="50" />
<xen:spinboxunit label="{xen:phrase bdimage_thumbnail_height}" name="{$namePrefix}thumbnail_height" value="{xen:if 'isset({$options.thumbnail_height})', {$options.thumbnail_height}, 100}" min="1" step="50" />
<xen:spinboxunit label="{xen:phrase title}" name="{$namePrefix}title" value="{xen:if 'isset({$options.title})', {$options.title}, 50}" min="0" step="25" />

<xen:spinboxunit label="{xen:phrase bdimage_gap}" name="{$namePrefix}gap" value="{xen:if 'isset({$options.gap})', {$options.gap}, 10}" min="1" step="10" />
<xen:spinboxunit label="{xen:phrase bdimage_visible_count}" name="{$namePrefix}visible_count" value="{xen:if 'isset({$options.visible_count})', {$options.visible_count}, 1}" min="1" />]]></template>
    <template title="bdimage_widget_options_threads"><![CDATA[<xen:include template="wf_widget_options_threads" />

<xen:spinboxunit label="{xen:phrase bdimage_thumbnail_width}" name="{$namePrefix}thumbnail_width" value="{xen:if 'isset({$options.thumbnail_width})', {$options.thumbnail_width}, 100}" min="1" step="50" />
<xen:spinboxunit label="{xen:phrase bdimage_thumbnail_height}" name="{$namePrefix}thumbnail_height" value="{xen:if 'isset({$options.thumbnail_height})', {$options.thumbnail_height}, 100}" min="1" step="50" />
<xen:spinboxunit label="{xen:phrase bdimage_gap}" name="{$namePrefix}gap" value="{xen:if 'isset({$options.gap})', {$options.gap}, 10}" min="1" step="10" />]]></template>
    <template title="bdimage_widget_options_threads_grid"><![CDATA[<xen:include template="wf_widget_options_threads" />

<xen:spinboxunit label="{xen:phrase bdimage_columns}:" name="{$namePrefix}grid_columns" value="{xen:if '!empty({$options.grid_columns})', $options.grid_columns, 5}" />

<xen:spinboxunit label="{xen:phrase bdimage_thumbnail_width}" name="{$namePrefix}thumbnail_width" value="{xen:if 'isset({$options.thumbnail_width})', {$options.thumbnail_width}, 50}" min="1" step="25" />
<xen:spinboxunit label="{xen:phrase bdimage_thumbnail_height}" name="{$namePrefix}thumbnail_height" value="{xen:if 'isset({$options.thumbnail_height})', {$options.thumbnail_height}, 50}" min="1" step="25" />
<xen:spinboxunit label="{xen:phrase bdimage_gap}" name="{$namePrefix}gap" value="{xen:if 'isset({$options.gap})', {$options.gap}, 5}" min="1" step="5" />
]]></template>
    <template title="bdimage_widget_options_threads_two"><![CDATA[<xen:include template="wf_widget_options_threads" />

<xen:spinboxunit label="{xen:phrase bdimage_feature_width}" name="{$namePrefix}feature_width" value="{xen:if 'isset({$options.feature_width})', {$options.feature_width}, 300}" min="1" step="100" />
<xen:spinboxunit label="{xen:phrase bdimage_feature_height}" name="{$namePrefix}feature_height" value="{xen:if 'isset({$options.feature_height})', {$options.feature_height}, 200}" min="1" step="100" />
<xen:spinboxunit label="{xen:phrase bdimage_feature_body}" name="{$namePrefix}feature_body" value="{xen:if 'isset({$options.feature_body})', {$options.feature_body}, 0}" min="0" step="50" />

<xen:spinboxunit label="{xen:phrase bdimage_small_size}" name="{$namePrefix}small_size" value="{xen:if 'isset({$options.small_size})', {$options.small_size}, 0}" min="0" step="50" />
<xen:spinboxunit label="{xen:phrase bdimage_small_title}" name="{$namePrefix}small_title" value="{xen:if 'isset({$options.small_title})', {$options.small_title}, 50}" min="1" step="25" />
<xen:spinboxunit label="{xen:phrase bdimage_small_column_width}" name="{$namePrefix}small_column_width" value="{xen:if 'isset({$options.small_column_width})', {$options.small_column_width}, 150}" min="1" step="50" explain="{xen:phrase bdimage_small_column_explain}" />

<xen:spinboxunit label="{xen:phrase bdimage_column_gap}" name="{$namePrefix}column_gap" value="{xen:if 'isset({$options.column_gap})', {$options.column_gap}, 10}" min="1" step="10" />
<xen:spinboxunit label="{xen:phrase bdimage_row_gap}" name="{$namePrefix}row_gap" value="{xen:if 'isset({$options.row_gap})', {$options.row_gap}, 3}" min="1" step="5" />

]]></template>
  </admin_templates>
  <admin_template_modifications/>
  <code_events/>
  <code_event_listeners>
    <listener event_id="file_health_check" execute_order="10" callback_class="bdImage_Listener" callback_method="file_health_check" active="1" hint="" description=""/>
    <listener event_id="init_dependencies" execute_order="10" callback_class="bdImage_Listener" callback_method="init_dependencies" active="1" hint="" description=""/>
    <listener event_id="load_class" execute_order="10" callback_class="bdImage_Listener" callback_method="load_class" active="1" hint="" description=""/>
    <listener event_id="template_hook" execute_order="10" callback_class="bdImage_Listener" callback_method="template_hook" active="1" hint="" description=""/>
    <listener event_id="widget_framework_ready" execute_order="10" callback_class="bdImage_Listener" callback_method="widget_framework_ready" active="1" hint="" description=""/>
  </code_event_listeners>
  <cron/>
  <email_templates/>
  <email_template_modifications/>
  <optiongroups>
    <group group_id="bdImage" display_order="9999" debug_only="0"/>
    <option option_id="bdImage_allAttachments" edit_format="onoff" data_type="unsigned_integer" can_backup="1">
      <default_value>0</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="bdImage" display_order="1000"/>
    </option>
    <option option_id="bdImage_template" edit_format="checkbox" data_type="array" can_backup="1">
      <default_value></default_value>
      <edit_format_params>thread_list_item_thread_image = {xen:phrase bdimage_template_thread_list_item_thread_image}
node_forum_last_thread_image = {xen:phrase bdimage_template_node_forum_last_thread_image}
search_result_thread_image = {xen:phrase bdimage_template_search_result_thread_image}</edit_format_params>
      <sub_options>*</sub_options>
      <relation group_id="bdImage" display_order="2000"/>
    </option>
  </optiongroups>
  <permissions>
    <permission_groups/>
    <permissions/>
    <interface_groups/>
  </permissions>
  <phrases>
    <phrase title="bdimage_columns" version_id="18" version_string="0.9.7b"><![CDATA[Columns]]></phrase>
    <phrase title="bdimage_column_gap" version_id="14" version_string="0.9.5"><![CDATA[Column Gap]]></phrase>
    <phrase title="bdimage_feature_body" version_id="14" version_string="0.9.5"><![CDATA[Display first post message of the feature thread]]></phrase>
    <phrase title="bdimage_feature_height" version_id="14" version_string="0.9.5"><![CDATA[Feature Image Height]]></phrase>
    <phrase title="bdimage_feature_width" version_id="14" version_string="0.9.5"><![CDATA[Feature Image Width]]></phrase>
    <phrase title="bdimage_gap" version_id="10" version_string="0.9-dev"><![CDATA[Gap (between thumbnails)]]></phrase>
    <phrase title="bdimage_rows" version_id="18" version_string="0.9.7b"><![CDATA[Rows]]></phrase>
    <phrase title="bdimage_row_gap" version_id="14" version_string="0.9.5"><![CDATA[Row Gap]]></phrase>
    <phrase title="bdimage_small_column_explain" version_id="14" version_string="0.9.5"><![CDATA[Set the size of the second column to control how it show up next to the feature thread. To disable thumbnail for this column, choose 0 as the thumbnail size.]]></phrase>
    <phrase title="bdimage_small_column_width" version_id="14" version_string="0.9.5"><![CDATA[Second Column Width]]></phrase>
    <phrase title="bdimage_small_size" version_id="14" version_string="0.9.5"><![CDATA[Second Column Thumbnail Width]]></phrase>
    <phrase title="bdimage_small_title" version_id="14" version_string="0.9.5"><![CDATA[Second Column Title]]></phrase>
    <phrase title="bdimage_template_node_forum_last_thread_image" version_id="14" version_string="0.9.5"><![CDATA[Last Thread Image in Forum List]]></phrase>
    <phrase title="bdimage_template_search_result_thread_image" version_id="14" version_string="0.9.5"><![CDATA[Thread Image in search result]]></phrase>
    <phrase title="bdimage_template_thread_list_item_thread_image" version_id="14" version_string="0.9.5"><![CDATA[Thread Image in Thread List]]></phrase>
    <phrase title="bdimage_thread_image" version_id="13" version_string="0.9.4"><![CDATA[Thread Image]]></phrase>
    <phrase title="bdimage_thumbnail_height" version_id="10" version_string="0.9-dev"><![CDATA[Thumbnail Height]]></phrase>
    <phrase title="bdimage_thumbnail_width" version_id="10" version_string="0.9-dev"><![CDATA[Thumbnail Width]]></phrase>
    <phrase title="bdimage_visible_count" version_id="10" version_string="0.9-dev"><![CDATA[Visible Thumbnails]]></phrase>
    <phrase title="option_bdImage_allAttachments" version_id="20" version_string="0.10.0-dev"><![CDATA[Consider All Attachments for Image]]></phrase>
    <phrase title="option_bdImage_allAttachments_explain" version_id="20" version_string="0.10.0-dev"><![CDATA[By default, only attachments that are included in the message are considered to be the feature image of a piece of content. Enable this option to check for all attachments.]]></phrase>
    <phrase title="option_bdImage_template" version_id="14" version_string="0.9.5"><![CDATA[Template Modification]]></phrase>
    <phrase title="option_bdImage_template_explain" version_id="20" version_string="0.10.0-dev"><![CDATA[Tick the modifications you wish to apply automatically.]]></phrase>
    <phrase title="option_group_bdImage" version_id="14" version_string="0.9.5"><![CDATA[[bd] Image]]></phrase>
    <phrase title="option_group_bdImage_description" version_id="14" version_string="0.9.5"><![CDATA[]]></phrase>
  </phrases>
  <route_prefixes/>
  <style_properties/>
  <templates>
    <template title="bdimage.css" version_id="17" version_string="0.9.7"><![CDATA[.bdImage_lastThreadImage
{
	float: left;
	margin-right: 5px;
	width: 30px;
	height: 30px;
}

ul.bdImage_Picker
{
}
	ul.bdImage_Picker > li
	{
		display: inline-block;
	}
	ul.bdImage_Picker > li.other
	{
		display: block;
	}]]></template>
    <template title="bdimage_grid_inline_css" version_id="19" version_string="0.10.0-dev"><![CDATA[<xen:set var="$gridWidth">{xen:calc '({$widget.options.thumbnail_width} + {$widget.options.gap}) * {$widget.options.grid_columns}'}</xen:set>
<xen:set var="$maxWidthInSidebar">{xen:calc '{xen:property sidebar.width} - {xen:property secondaryContent.padding-left} - {xen:property secondaryContent.padding-right}'}</xen:set>
<xen:container var="$head.{$cssClass}">
<style>
.{$cssClass}
{
	width: {$gridWidth}px;
}
	.{$cssClass} li
	{
		margin-right: {$widget.options.gap}px;
	}

	.{$cssClass} img
	{
		width: {$widget.options.thumbnail_width}px;
		height: {$widget.options.thumbnail_height}px;
	}

<xen:if is="{$widget.options.thumbnail_width} > {$maxWidthInSidebar}">
	.sidebar .{$cssClass}
	{
		width: {xen:calc '({$maxWidthInSidebar} + {$widget.options.gap}) * {$widget.options.grid_columns}'}px;
	}
	
	.sidebar .{$cssClass} img
	{
		width: {$maxWidthInSidebar}px;
		height: {xen:calc 'floor({$maxWidthInSidebar} / {$widget.options.thumbnail_width} * {$widget.options.thumbnail_height})'}px;
	}
</xen:if>

<xen:if is="{xen:property enableResponsive}">
@media (max-width:{xen:property maxResponsiveWideWidth})
{
	.non-sidebar-widget .{$cssClass}
	{
		width: 100%;
	}
		.non-sidebar-widget .{$cssClass} li
		{
			margin-right: 0;
			width: {xen:calc '100 / {$widget.options.grid_columns}'}%;
		}
		.non-sidebar-widget .{$cssClass} img
		{
			width: 100%;
			height: auto;
		}

}
</xen:if>

</style>
</xen:container>]]></template>
    <template title="bdimage_picker" version_id="17" version_string="0.9.7"><![CDATA[<xen:if is="{$images}">

	<xen:require css="bdimage.css" />

	<div>
		<ul class="bdImage_Picker">
			<xen:set var="$currentImageFound">0</xen:set>

			<xen:foreach loop="$images" value="$image">
				<xen:set var="$safeUrl">{xen:helper bdImage_safeUrl, $image}</xen:set>
				<xen:if is="{$safeUrl} == {$currentImage}">
					<xen:set var="$currentImageFound">1</xen:set>
				</xen:if>

				<li><label>

					<input type="radio" name="bdimage_image" value="{$safeUrl}"
						   style="height: 48px"
						   {xen:checked '{$safeUrl} == {$currentImage}'}/>
					<img src="{xen:helper bdImage_thumbnail, $image, 48, 48}" width="48" height="48" />

				</label></li>
			</xen:foreach>

			<li class="other">
				<label>
					<input type="radio" name="bdimage_image" value="other" class="Disabler" id="ctrl_bdimage_image_other" {xen:checked '{$currentImageFound} == 0'}/>
					{xen:phrase other}
				</label><br/>
				<br/>
				<div id="ctrl_bdimage_image_other_Disabler">
					<input type="text" name="bdimage_other" value="{xen:if '{$currentImageFound} == 0', '{$currentImage}'}" class="textCtrl" />
				</div>
			</li>
		</ul>
	</div>

<xen:else />

	<input type="hidden" name="bdimage_image" value="other" />
	<input type="text" name="bdimage_other" value="{$currentImage}" class="textCtrl" />

</xen:if>

<input type="hidden" name="bdimage_picker" value="1" />
<input type="hidden" name="bdimage_current_image" value="{$currentImage}" />

<xen:edithint template="bdimage_picker_simple" />]]></template>
    <template title="bdimage_picker_simple" version_id="17" version_string="0.9.7"><![CDATA[<xen:if is="{$images}">

	<select {xen:if '{$id}', 'id="{$id}"'} name="bdimage_image" class="textCtrl bdImage_Picker">
		<xen:set var="$currentImageFound">0</xen:set>
		<xen:foreach loop="$images" value="$image">
			<xen:set var="$safeUrl">{xen:helper bdImage_safeUrl, $image}</xen:set>
			<xen:if is="{$safeUrl} == {$currentImage}">
				<xen:set var="$currentImageFound">1</xen:set>
			</xen:if>

			<option value="{$safeUrl}" {xen:selected '{$safeUrl} == {$currentImage}'}>{xen:helper bdImage_filename, $safeUrl}</option>
		</xen:foreach>

		<xen:if is="{$currentImageFound} == 0">
			<option value="{$currentImage}" selected="selected">{xen:helper bdImage_filename, $currentImage}</option>
		</xen:if>
	</select>

	<input type="hidden" name="bdimage_picker" value="1" />
	<input type="hidden" name="bdimage_current_image" value="{$currentImage}" />

</xen:if>

	
]]></template>
    <template title="bdimage_widget.css" version_id="19" version_string="0.10.0-dev"><![CDATA[.bdImage_Widget_Slider_Container
{
	overflow: hidden;
}

	.bdImage_Widget_Slider_Container .jcarousel-clip
	{
		margin: 0 auto;
		overflow: hidden;
	}

	.bdImage_Widget_Slider_Container .jcarousel-prev-horizontal,
	.bdImage_Widget_Slider_Container .jcarousel-prev-horizontal:after
	{
		position: absolute;
		left: 5px;
		width: 32px;
		height: 32px;
		cursor: pointer;
		background: transparent;
	}
	.bdImage_Widget_Slider_Container .jcarousel-next-horizontal,
	.bdImage_Widget_Slider_Container .jcarousel-next-horizontal:after
	{
		position: absolute;
		right: 5px;
		width: 32px;
		height: 32px;
		cursor: pointer;
		background: transparent;
	}

	.bdImage_Widget_Slider_Container .jcarousel-prev-horizontal:after
	{
		content: '←';
		line-height: 15px;
		font-size: 30px;
	}
	.bdImage_Widget_Slider_Container .jcarousel-next-horizontal:after
	{
		content: '→';
		font-size: 30px;
	}

.bdImage_Widget_Items
{
}
{xen:helper clearfix, '.bdImage_Widget_Items'}
	.bdImage_Widget_Items > li
	{
		float: left;
	}

.bdImage_WidgetRenderer_ThreadsTwo
	{
		display: block;
	}
	
	.bdImage_WidgetRenderer_ThreadsTwo .bdImage_Feature
	{
		display: block;
		float: left;
		overflow: hidden;
	}

		.bdImage_WidgetRenderer_ThreadsTwo .bdImage_Feature .text .title
		{
			width: 100%;
			overflow: hidden;
			text-overflow: ellipsis;
			white-space: nowrap;
		}

		.bdImage_WidgetRenderer_ThreadsTwo .bdImage_Feature .text .body
		{
			text-align: justify;
		}
	
	.bdImage_WidgetRenderer_ThreadsTwo .bdImage_Small
	{
		display: block;
		float: none;
		overflow: hidden;
	}
			
	.bdImage_WidgetRenderer_ThreadsTwo .bdImage_Small.bdImage_SmallWithThumbnail .thumbnail
	{
		display: block;
		float: left;
	}
	
	.{$cssClass} .bdImage_Small.bdImage_SmallWithThumbnail .text
	{
		display: block;
		float: none;
	}
	{xen:helper clearfix, '.{$cssClass} .bdImage_Small.bdImage_SmallWithThumbnail li'}
	
	.bdImage_WidgetRenderer_ThreadsTwo .bdImage_Small li
	{
		border-bottom: 1px dashed {xen:property primaryLighterStill};
		display: block;
		float: none;
		overflow: hidden;
	}

.bdImage_Widget_Grid_Container
{
	overflow: hidden;
	overflow-x: scroll;
	width: 100%;
}
ul.bdImage_Widget_Grid
{
	list-style: none;
	margin: 0;
	padding: 0;
}
{xen:helper clearfix, 'ul.bdImage_Widget_Grid'}
	.bdImage_Widget_Grid li
	{
		float: left;
	}
	.bdImage_Widget_Grid a
	{
		display: block;
	}
]]></template>
    <template title="bdimage_widget_attachments_grid" version_id="19" version_string="0.10.0-dev"><![CDATA[<xen:if hascontent="true">
	<xen:set var="$cssClass">{xen:helper bdImage_Widget_Slider_CssClass, $widget}</xen:set>
	<xen:include template="bdimage_grid_inline_css" />
	<xen:require css="bdimage_widget.css" />

	<div class="bdImage_Widget_Grid_Container">
		<ul class="bdImage_Widget_Grid {$cssClass}">
			<xen:contentcheck>
				<xen:foreach loop="$posts" value="$post">
					<li>
						<a href="{xen:link posts, $post}" title="{$post.title}" class="Tooltip">
							<img src="{xen:helper bdImage_thumbnail,
								$post.attachmentUri,
								{$widget.options.thumbnail_width},
								{$widget.options.thumbnail_height}}" />
						</a>
					</li>
				</xen:foreach>
			</xen:contentcheck>
		</ul>
	</div>
</xen:if>]]></template>
    <template title="bdimage_widget_slider_threads" version_id="16" version_string="0.9.6b"><![CDATA[<xen:if hascontent="true">
	<xen:set var="$cssClass">{xen:helper bdImage_Widget_Slider_CssClass, $widget}</xen:set>
	<xen:container var="$head.{$cssClass}">
<style>
.{$cssClass} .jcarousel-clip
{
	width: {xen:calc '{$widget.options.thumbnail_width}*{$widget.options.visible_count} + {$widget.options.gap}*({$widget.options.visible_count}-1)'}px;
}
.{$cssClass} .jcarousel-prev-horizontal,
.{$cssClass} .jcarousel-next-horizontal {
	top: {xen:if '{$widget.options.title}', {xen:calc '{$widget.options.thumbnail_height} - 32'}, {xen:calc '({$widget.options.thumbnail_height} - 32) / 2'}}px;
}
.{$cssClass} ul.bdImage_Widget_Slider_Items > li
{
	padding-right: {$widget.options.gap}px;
	width: {$widget.options.thumbnail_width}px;
}
</style>
	</xen:container>
	
	<xen:require css="bdimage_widget.css" />
	<xen:require js="js/bdImage/widget_slider.js" />
	<xen:require js="js/bdImage/jquery.jcarousel.js" />

    <div class="bdImage_Widget_Slider_Container bdImage_Widget_SliderThreads_Container {$cssClass}">
        <ul class="bdImage_Widget_Slider_Items">
            <xen:contentcheck>
				<xen:if is="{$threads}">
					<xen:include template="bdimage_widget_thread_item">
						<xen:set var="$bdImageWidgetThread_showTitle">{$widget.options.title}</xen:set>
					</xen:include>
				</xen:if>
            </xen:contentcheck>
        </ul>
    </div>
</xen:if>]]></template>
    <template title="bdimage_widget_threads" version_id="16" version_string="0.9.6b"><![CDATA[<xen:if hascontent="true">
	<xen:set var="$cssClass">{xen:helper bdImage_Widget_Slider_CssClass, $widget}</xen:set>
	<xen:container var="$head.{$cssClass}">
<style>
.{$cssClass}
{
	overflow: hidden;
	width: 100%;
}
	.{$cssClass} ul.bdImage_Widget_Items > li
	{
		padding-right: {$widget.options.gap}px;
		width: {$widget.options.thumbnail_width}px;
	}
		.{$cssClass} ul.bdImage_Widget_Items > li:last-child
		{
			padding-right: 0;
		}
	
.non-sidebar-widget .{$cssClass}
{
	overflow-x: auto;

}
	.{$cssClass} ul.bdImage_Widget_Items
	{
		width: {xen:calc '{$widget.options.thumbnail_width}*{xen:count $threads} + {$widget.options.gap}*({xen:count $threads} - 1)'}px;		
	}

</style>
	</xen:container>
	
	<xen:require css="bdimage_widget.css" />

    <div class="{$cssClass}">
        <ul class="bdImage_Widget_Items">
            <xen:contentcheck>
				<xen:if is="{$new}">
					<xen:include template="bdimage_widget_thread_item">
						<xen:map from="$new" to="$threads" />
						<xen:set var="$bdImageWidgetThread_showToolTip">1</xen:set>
					</xen:include>
				<xen:elseif is="{$recent}"/>
					<xen:include template="bdimage_widget_thread_item">
						<xen:map from="$recent" to="$threads" />
						<xen:set var="$bdImageWidgetThread_showToolTip">1</xen:set>
					</xen:include>
				<xen:elseif is="{$popular}"/>
					<xen:include template="bdimage_widget_thread_item">
						<xen:map from="$popular" to="$threads" />
						<xen:set var="$bdImageWidgetThread_showToolTip">1</xen:set>
					</xen:include>
				<xen:elseif is="{$mostReplied}"/>
					<xen:include template="bdimage_widget_thread_item">
						<xen:map from="$mostReplied" to="$threads" />
						<xen:set var="$bdImageWidgetThread_showToolTip">1</xen:set>
					</xen:include>
				<xen:elseif is="{$mostLiked}"/>
					<xen:include template="bdimage_widget_thread_item">
						<xen:map from="$mostLiked" to="$threads" />
						<xen:set var="$bdImageWidgetThread_showToolTip">1</xen:set>
					</xen:include>
				<xen:elseif is="{$polls}"/>
					<xen:include template="bdimage_widget_thread_item">
						<xen:map from="$polls" to="$threads" />
						<xen:set var="$bdImageWidgetThread_showToolTip">1</xen:set>
					</xen:include>
				<xen:elseif is="{$threads}" />
					<xen:include template="bdimage_widget_thread_item">
						<xen:set var="$bdImageWidgetThread_showToolTip">1</xen:set>
					</xen:include>
				</xen:if>
            </xen:contentcheck>
        </ul>
    </div>
</xen:if>]]></template>
    <template title="bdimage_widget_threads_grid" version_id="19" version_string="0.10.0-dev"><![CDATA[<xen:if hascontent="true">
	<xen:set var="$cssClass">{xen:helper bdImage_Widget_Slider_CssClass, $widget}</xen:set>
	<xen:include template="bdimage_grid_inline_css" />
	<xen:require css="bdimage_widget.css" />

	<div class="bdImage_Widget_Grid_Container">
		<ul class="bdImage_Widget_Grid {$cssClass}">
			<xen:contentcheck>
				<xen:foreach loop="$threads" value="$thread">
					<li>
						<a href="{xen:link threads, $thread}" title="{$thread.title}" class="Tooltip">
							<img src="{xen:helper bdImage_thumbnail,
								$thread.bdimage_image,
								{$widget.options.thumbnail_width},
								{$widget.options.thumbnail_height}}" />
						</a>
					</li>
				</xen:foreach>
			</xen:contentcheck>
		</ul>
	</div>
</xen:if>]]></template>
    <template title="bdimage_widget_threads_two" version_id="14" version_string="0.9.5"><![CDATA[<xen:set var="$cssClass">bdImage_WidgetRenderer_ThreadsTwo-{$widget.widget_id}</xen:set>
<xen:container var="$head.{$cssClass}">
<style>
	.{$cssClass}
	{
		width: {xen:calc '{$widget.options.feature_width} + {$widget.options.column_gap} + {$widget.options.small_column_width}'}px;
	}

	.{$cssClass} .bdImage_Feature
	{
		width: {$widget.options.feature_width}px;
	}

	.{$cssClass} .bdImage_Small
	{
		margin-left: {xen:calc '{$widget.options.feature_width} + {$widget.options.column_gap}'}px;
		width: {$widget.options.small_column_width}px;
	}
			
	<xen:if is="{$widget.options.small_size}">
			.{$cssClass} .bdImage_Small .text
			{
				margin-left: {xen:calc '{$widget.options.small_size} + {$widget.options.column_gap}'}px;
				width: {xen:calc '{$widget.options.small_column_width} - {$widget.options.small_size} - {$widget.options.column_gap}'}px;
				height: {$widget.options.small_size}px;
			}
			{xen:helper clearfix, '.{$cssClass} .bdImage_Small li'}
	</xen:if>
	
	.{$cssClass} .bdImage_Small li
	{
		width: {$widget.options.small_column_width}px;
		min-height: {xen:calc '{$widget.options.feature_height} / ({$widget.options.limit} - 1) - {$widget.options.row_gap}'}px;
	}
</style>
</xen:container>

<xen:require css="bdimage_widget.css" />

<div class="bdImage_WidgetRenderer_ThreadsTwo {$cssClass}">
	<xen:foreach loop="$threads" i="$i" value="$firstThread"><xen:if is="{$i} == 1">
	<div class="bdImage_Feature">
		<div class="thumbnail">
			<a href="{xen:link threads, $firstThread}">
				<img src="{xen:helper bdImage_thumbnail,
					$firstThread.bdimage_image,
					{$widget.options.feature_width},
					{$widget.options.feature_height}}" {xen:helper bdImage_imgAttribs,
					$firstThread.bdimage_image,
					{$widget.options.feature_width},
					{$widget.options.feature_height}} />
			</a>
		</div>
		<div class="text">
			<p class="title"><a href="{xen:link threads, $firstThread}">{$firstThread.title}</a></p>

			<xen:if is="{$widget.options.feature_body} AND {$firstThread.message}">
				<p class="body">{xen:helper snippet, $firstThread.message, {$widget.options.feature_body}}</p>
			</xen:if>
		</div>
	</div>
	</xen:if></xen:foreach>
	<div class="bdImage_Small {xen:if '{$widget.options.small_size}', 'bdImage_SmallWithThumbnail'}">
		<ul>
		<xen:foreach loop="$threads" i="$i" value="$thread">
			<xen:if is="{$i} > 1">
				<li>
					<xen:if is="{$widget.options.small_size}">
						<div class="thumbnail">
							<a href="{xen:link threads, $thread}">
								<img src="{xen:helper bdImage_thumbnail,
									$thread.bdimage_image,
									{$widget.options.small_size},
									{$widget.options.small_size}}" {xen:helper bdImage_imgAttribs,
									$thread.bdimage_image,
									{$widget.options.small_size},
									{$widget.options.small_size}} />
							</a>
						</div>
					</xen:if>
					<div class="text"><a href="{xen:link threads, $thread}">{xen:helper snippet, $thread.title, $widget.options.small_title}</a></div>
				</li>
			</xen:if>
		</xen:foreach>
		</ul>
	</div>
</div>]]></template>
    <template title="bdimage_widget_thread_item" version_id="16" version_string="0.9.6b"><![CDATA[<xen:foreach loop="$threads" value="$thread">
	<xen:if is="{$thread.bdimage_image}">
		<li>
			<a href="{xen:link threads, $thread}"
				<xen:if is="{$bdImageWidgetThread_showToolTip}">
				class="Tooltip" title="{$thread.title} {xen:phrase by} {$thread.username}"
				data-offsetx="10" data-offsety="{xen:calc '5 - {$widget.options.thumbnail_height}'}"
				</xen:if>
				>
				<img src="{xen:helper bdImage_thumbnail,
					$thread.bdimage_image,
					{$widget.options.thumbnail_width},
					{$widget.options.thumbnail_height}}" {xen:helper bdImage_imgAttribs,
					$thread.bdimage_image,
					{$widget.options.thumbnail_width},
					{$widget.options.thumbnail_height}} />
			</a>

			<xen:if is="{$bdImageWidgetThread_showTitle}">
				<a href="{xen:link threads, $thread}">
					{xen:helper snippet, $thread.title, $bdImageWidgetThread_showTitle}
				</a>
			</xen:if>
		</li>
	</xen:if>
</xen:foreach>]]></template>
  </templates>
  <public_template_modifications>
    <modification template="node_forum_level_2" modification_key="bdimage_node_forum_last_thread_image" description="Template Modification: Last Thread Image in Forum List." execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:elseif is="{$forum.lastPost.date}" />]]></find>
      <replace><![CDATA[$0

<xen:if is="{xen:helper bdImage_getOption, template, node_forum_last_thread_image} AND !!{xen:helper bdImage_image, $forum.bdimage_last_post_image}">

	<xen:require css="bdimage.css" />
	<img src="{xen:helper bdImage_thumbnail, $forum.bdimage_last_post_image, 48, 48}" class="bdImage_lastThreadImage" />

</xen:if>]]></replace>
    </modification>
    <modification template="post_edit" modification_key="bdimage_post_edit_picker" description="Insert thread image picker into post_edit form." execution_order="10" enabled="1" action="preg_replace">
      <find><![CDATA[#<xen:if is="{\$attachmentParams}">(.|\r|\n)+</xen:if>#]]></find>
      <replace><![CDATA[<xen:if is="{$post.post_id} == {$thread.first_post_id}">

	<dl class="ctrlUnit">
		<dt>{xen:phrase bdimage_thread_image}:</dt>
		<dd>
			<xen:include template="bdimage_picker">
				<xen:map from="$bdImage_images" to="$images" />
				<xen:set var="$currentImage">{xen:helper bdImage_image, $thread.bdimage_image}</xen:set>
			</xen:include>
		</dd>
	</dl>

</xen:if>

$0]]></replace>
    </modification>
    <modification template="search_result_thread" modification_key="bdimage_search_result_thread_image" description="Template Modification: Thread Image in search result." execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:avatar user="$thread" size="s" img="true" />]]></find>
      <replace><![CDATA[<xen:if is="{xen:helper bdImage_getOption, template, search_result_thread_image} AND !!{xen:helper bdImage_image, $thread.bdimage_image}">

	<a href="{xen:link threads, $thread}" class="avatar NoOverlay">
		<img src="{xen:helper bdImage_thumbnail, $thread.bdimage_image, 48, 48}" />
	</a>

<xen:else />
	$0
</xen:if>]]></replace>
    </modification>
    <modification template="thread_edit" modification_key="bdimage_thread_edit_picker" description="Insert image picker into thread_edit form." execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<dl class="ctrlUnit submitUnit">]]></find>
      <replace><![CDATA[<xen:if hascontent="true">
	<dl class="ctrlUnit">
		<dt><label for="ctrl_bdimage_image">{xen:phrase image}:</label></dt>
		<dd>
			<xen:contentcheck>
			<xen:include template="bdimage_picker">
				<xen:map from="$bdImage_images" to="$images" />
				<xen:set var="$currentImage">{xen:helper bdImage_image, $thread.bdimage_image}</xen:set>
			</xen:include>
			</xen:contentcheck>
		</dd>
	</dl>
</xen:if>

$0]]></replace>
    </modification>
    <modification template="thread_list_item_edit" modification_key="bdimage_thread_list_item_edit_picker" description="Insert image picker into thread_list_item_edit form." execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<div class="buttons editBlock">]]></find>
      <replace><![CDATA[<xen:if hascontent="true">
	<div class="bdImage_imageEdit editBlock">
		<label>
			{xen:phrase image}:

			<xen:contentcheck>
			<xen:include template="bdimage_picker_simple">
				<xen:map from="$bdImage_images" to="$images" />
				<xen:set var="$currentImage">{xen:helper bdImage_image, $thread.bdimage_image}</xen:set>
			</xen:include>
			</xen:contentcheck>
		</label>
	</div>
</xen:if>


$0]]></replace>
    </modification>
    <modification template="thread_list_item" modification_key="bdimage_thread_list_item_thread_image" description="Template Modification: Thread Image in Thread List." execution_order="10" enabled="1" action="preg_replace">
      <find><![CDATA[#(<span class="avatarContainer">[^<]+)(<xen:avatar.+/>)#]]></find>
      <replace><![CDATA[$1

<xen:if is="{xen:helper bdImage_getOption, template, thread_list_item_thread_image} AND !!{xen:helper bdImage_image, $thread.bdimage_image}">

	<a href="{xen:link threads, $thread}" class="avatar NoOverlay">
		<img src="{xen:helper bdImage_thumbnail, $thread.bdimage_image, 48, 48}" />
	</a>

<xen:else />
	$2
</xen:if>]]></replace>
    </modification>
  </public_template_modifications>
  <bb_code_media_sites/>
</addon>
